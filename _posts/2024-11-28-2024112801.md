---
title: "[React] Next.jsë¡œ ì•Œì•„ë³´ëŠ” @emotion/styledì™€ styled-components"
date: 2024-11-28
published: true
toc: true
toc_sticky: true
last_modified_at: 2024-11-28
categories:
  - React
tags:
  - Next.js
  - CSS
  - CSS Library
  - "@emotion/styled"
  - emotion
  - styled-components
  - Server Side Rendering
  - SSR
---

## 1. ì„œë¡ 

CSS ìŠ¤íƒ€ì¼ì„ ì»´í¬ë„ŒíŠ¸ì²˜ëŸ¼ ì ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ëŠ” ëŒ€í‘œì ìœ¼ë¡œ `styled-components`ê°€ ìˆì–´ìš”.

- ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” CSS-in-JSë¼ëŠ” ë°©ë²•ìœ¼ë¡œ CSS ì†ì„±ì„ Javascript ì½”ë“œë¡œ í¸í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆì–´ìš”.
- ë˜í•œ, ì ìš©í•˜ë ¤ëŠ” HTML ìš”ì†Œì— ì´ë¦„ì„ ë¶™ì¼ ìˆ˜ ìˆì–´ì„œ ì˜ë¯¸ë¡ ì ìœ¼ë¡œ ì§ê´€ì ì´ê¸°ë„ í•´ìš”.

ì´ì™€ ë¹„ìŠ·í•˜ê²Œ `@emotion/styled`ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì¡´ì¬í•´ìš”. íŒ¨í‚¤ì§€ ì´ë¦„ë§Œ ë°”ê¿”ë„ ë  ì •ë„ë¡œ APIì™€ ì‚¬ìš©ë²•ì´ `styled-components`ì™€ ìƒë‹¹íˆ ë¹„ìŠ·í•œ íŠ¹ì§•ì´ ìˆì–´ìš”.

ê¸°ë³¸ì ìœ¼ë¡œ ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§(CSR)ì—ì„œ ì‚¬ìš©ë˜ì§€ë§Œ, ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§(SSR)ì—ì„œë„ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì§€ì›í•´ìš”.

í‰ì†Œì— ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì°¨ì´ì ì— ëŒ€í•´ ê¶ê¸ˆí–ˆì—ˆëŠ”ë°, ì´ë²ˆì— kanji-yomi í”„ë¡œì íŠ¸ë¥¼ Next.jsë¡œ ì§„í–‰í•˜ë©´ì„œ ë°œê²¬í•œ ì°¨ì´ì ì— ëŒ€í•´ ì•Œì•„ë³´ë ¤ê³  í•´ìš”.

ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ë¥¼ ì¤‘ì ìœ¼ë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

## 2. styled-components ë¼ì´ë¸ŒëŸ¬ë¦¬

ë¨¼ì €, `styled-components` ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ì•Œì•„ë³¼ê²Œìš”.

`styled-components`ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§ˆë‹¤ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì— í•„ìš”í•œ ìŠ¤íƒ€ì¼ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ `<style>` íƒœê·¸ë¡œ ì‚½ì…í•˜ëŠ” CSR ì¤‘ì‹¬ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ìš”.

Next.jsì²˜ëŸ¼ SSR í™˜ê²½ì—ì„œëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì—ì„œ ë Œë”ë§ëœ HTML íŒŒì¼ì„ ì „ë‹¬ë°›ì•„ Reactì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ Hydrationì´ë¼ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•´ì•¼ í•´ìš”.

ì´ëŸ¬í•œ ê³¼ì •ì—ì„œ CSS ìŠ¤íƒ€ì¼ê³¼ ê´€ë ¨ëœ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œë“¤ì´ ë°œìƒí•  ìˆ˜ ìˆì–´ìš”.

1. className ë¶ˆì¼ì¹˜
2. Flickering

className ë¶ˆì¼ì¹˜ ë¬¸ì œëŠ” Next.js ì„œë²„ì—ì„œ ë Œë”ë§ì„ í•  ë•Œ ì„ ì–¸í•œ className ì²´í¬ì„¬ê³¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±í•œ CSS ìŠ¤íƒ€ì¼ì˜ className ì²´í¬ì„¬ì´ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë¬¸ì œì—ìš”. ê¸°ì¤€ì´ ë˜ëŠ” ì„œë²„ì—ì„œ ìƒì„±ëœ ì²´í¬ì„¬ì— í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìƒì„±ëœ ì²´í¬ì„¬ì´ ë§¤í•‘ë˜ì§€ ì•Šì•„ì„œ ìŠ¤íƒ€ì¼ì„ ì ìš©í•  ìˆ˜ ì—†ëŠ” ë¬¸ì œì—ìš”.

className ì²´í¬ì„¬ì´ ë§¤í•‘ì´ ë˜ì—ˆë‹¤ê³  í•˜ë”ë¼ë„, CSS ìŠ¤íƒ€ì¼ì„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìƒì„±í–ˆë‹¤ë©´ Flickering(ê¹œë¹¡ì„) ë¬¸ì œê°€ ë°œìƒí•  ì—¬ì§€ê°€ ìˆì–´ìš”. ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì´ˆê¸° HTMLì—ëŠ” CSS ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”. ì´í›„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë™ì ìœ¼ë¡œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ê³  í™”ë©´ì— ì ìš©ì´ ë  ë•Œê¹Œì§€ ì‹œê°„ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì—, í™”ë©´ì´ ë³€ê²½ë˜ë©´ì„œ ê¹œë¹¡ì„ì´ ë°œìƒí•˜ëŠ” ê²ƒì²˜ëŸ¼ ëŠê»´ì ¸ìš”. ì´ë¥¼ Flickeringì´ë¼ê³  í•˜ê³  ì•„ë˜ì—ì„œ ë‹¤ì‹œ ì„¤ëª…ì„ í•  ì˜ˆì •ì´ì—ìš”.

### 2-1. Next.jsì—ì„œ ê¸°ì¡´ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•´ë³´ê¸°

íŠ¹ë³„í•œ ì„¤ì •ì„ ë”°ë¡œ ì ìš©í•˜ì§€ ì•Šê³ , Next.jsì—ì„œ `styled-components`ë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ìŠ¤íƒ€ì¼ì´ ì „í˜€ ì ìš©ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="500px" src="/assets/images/2024112801/styled.gif" alt="styled" >
</div>

ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ì„œë²„ì—ì„œ ìƒì„±ëœ `jvrypf` classNameì´ `<style>` íƒœê·¸ ë‚´ì— ì¡´ì¬í•˜ëŠ” ì–´ëŠ classNameê³¼ë„ ë§¤í•‘ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì´ì—ìš”. í´ë¼ì´ì–¸íŠ¸ì—ì„œ CSS ìŠ¤íƒ€ì¼ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆì§€ë§Œ, ì œëŒ€ë¡œ ì—°ê²°ë˜ì§€ ì•Šì•„ì„œ ë°œìƒí•œ ì´ìŠˆì—ìš”.

<div style="display: flex; justify-content: center" >
  <img width="700px" src="/assets/images/2024112801/classname.png" alt="classname" >
</div>

### 2-2. className ë¶ˆì¼ì¹˜ ë¬¸ì œ

ë¨¼ì €, ìœ„ì—ì„œ ë°œìƒí•œ className ë¶ˆì¼ì¹˜ ë¬¸ì œëŠ” Next.jsì˜ `next.config.mjs` íŒŒì¼ì—ì„œ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.

`ğŸ“‚ next.config.mjs`

{% include code-header.html %}

```tsx
/** @type {import('next').NextConfig} */
const nextConfig = {
  compiler: {
    styledComponents: true,
  },
};

export default nextConfig;
```

- ìœ„ì™€ ê°™ì´ `compiler.styledComponents`ë¥¼ ì‘ì„±í•´ì¤˜ìš”.
- Next.jsê°€ ìë™ìœ¼ë¡œ [Babel í”ŒëŸ¬ê·¸ì¸(`babel-plugin-styled-components`)ì„ í™œì„±í™”](https://styled-components.com/docs/tooling#server-side-rendering)í•˜ì—¬ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ className ì²´í¬ì„¬ì˜ ì¼ì¹˜ë¥¼ ë³´ì¥í•´ìš”.

ì„¤ì •ì„ ì ìš©í•˜ë©´ ìì—°ìŠ¤ëŸ½ì§€ëŠ” ì•Šì§€ë§Œ, CSS ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”. ìš”ì†Œë“¤ì— CSS ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ë©´ì„œ ìì‹ ì˜ ìë¦¬ë¥¼ ì°¾ì•„ê°€ëŠ” í˜„ìƒì´ ë°œìƒí•˜ëŠ”ë°, ì´ë¥¼ Flickering(ê¹œë¹¡ì„)ì´ë¼ê³  í•´ìš”. í´ë¼ì´ì–¸íŠ¸ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ê³  ì ìš©í•˜ëŠ” ê³¼ì •ì—ì„œ ë¦¬í˜ì¸íŒ…ì´ ì¼ì–´ë‚˜ë©´ì„œ ê¹œë¹¡ì´ëŠ” í˜„ìƒì´ ë°œìƒí•˜ê³  ìˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="500px" src="/assets/images/2024112801/styled2.gif" alt="styled2" >
</div>

ì•„ë˜ ì‚¬ì§„ì„ í†µí•´ì„œë„, ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ CSS ìŠ¤íƒ€ì¼ì˜ classNameì´ ì„œë¡œ ì˜ ë§¤í•‘ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ë‹¤ì‹œ ë§í•´ì„œ, className ë¶ˆì¼ì¹˜ ë¬¸ì œëŠ” í•´ê²°ë˜ì—ˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="700px" src="/assets/images/2024112801/classname2.png" alt="classname2" >
</div>

ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬ëœ HTML íŒŒì¼(Page Source)ë¥¼ í™•ì¸í•´ë³´ë©´, `hbpnQW` classNameì€ ì°¾ì„ ìˆ˜ ìˆì§€ë§Œ CSS ìŠ¤íƒ€ì¼ì˜ ì‹¤ì²´ë¥¼ í™•ì¸í•  ìˆ˜ëŠ” ì—†ì–´ìš”. ì¦‰, ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•´ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ëœ»ì´ì—ìš”.

{% include code-header.html %}

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="/_next/static/css/app/layout.css?v=1732771235506"
      data-precedence="next_static/css/app/layout.css"
    />
    <!-- ... -->
  </head>
  <body class="__variable_f92059 __variable_013f1d">
    <!-- ... -->
    <div class="Test__Test1-sc-8ae5b2a9-0 hbpnQW">
      <div class="content-box">
        <main class="PageWithBottomNav__MainContainer-sc-8893f0af-0 jKFWJB">
          <!-- ... -->
        </main>
      </div>
    </div>
    <!-- ... -->
  </body>
</html>
```

Flickeringì€ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë™ì ìœ¼ë¡œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•  ë•Œ ë‚˜íƒ€ë‚  ìˆ˜ ë°–ì— ì—†ëŠ” í•„ì—°ì ì¸ í˜„ìƒì´ì—ìš”. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•´ìš”.

### 2-3. Flickering ë¬¸ì œ

[Next.js ê³µì‹ ë¬¸ì„œ](https://nextjs.org/docs/app/building-your-application/styling/css-in-js#styled-components)ì—ë„ ì„¤ëª…ë˜ì–´ ìˆë“¯ì´, `ServerStyleSheet`ë¥¼ í†µí•´ Flickering ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.

`ServerStyleSheet`ë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ì•„ìš”.

`ğŸ“‚ Registry.tsx`
{% include code-header.html %}

```tsx
"use client";

import React, { useState } from "react";
import { useServerInsertedHTML } from "next/navigation";
import { ServerStyleSheet, StyleSheetManager } from "styled-components";

export default function StyledComponentsRegistry({
  children,
}: {
  children: React.ReactNode;
}) {
  // Only create stylesheet once with lazy initial state
  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state
  const [styledComponentsStyleSheet] = useState(() => new ServerStyleSheet());

  useServerInsertedHTML(() => {
    const styles = styledComponentsStyleSheet.getStyleElement();
    styledComponentsStyleSheet.instance.clearTag();
    return <>{styles}</>;
  });

  if (typeof window !== "undefined") return <>{children}</>;

  return (
    <StyleSheetManager sheet={styledComponentsStyleSheet.instance}>
      {children}
    </StyleSheetManager>
  );
}
```

`ğŸ“‚ layout.tsx`
{% include code-header.html %}

```tsx
import StyledComponentsRegistry from "./registry";

// ...

return (
  <html lang="en">
    <body className={`${openSans.variable} ${openSansBold.variable}`}>
      <StyledComponentsRegistry>
        <div className="content-box">{children}</div>
      </StyledComponentsRegistry>
    </body>
  </html>
);
```

1. AÂ **style registry**Â to collect all CSS rules in a render.

   - ë Œë”ë§ ì¤‘ì— ëª¨ë“  CSS ìŠ¤íƒ€ì¼ì„ ìˆ˜ì§‘í•˜ëŠ” **registry ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•´ìš”.**

2. The newÂ `useServerInsertedHTML`Â hook to inject rules before any content that might use them.

   - ServerStyleSheet ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì„œë²„ ë Œë”ë§ ì¤‘ ìƒì„±í•  CSS ìŠ¤íƒ€ì¼ì„ ìˆ˜ì§‘í•´ìš”.
   - `useServerInsertedHTML` í›…ì„ í†µí•´ ë Œë”ë§ ë˜ê¸° ì „ì— CSS ìŠ¤íƒ€ì¼ì„ ì„œë²„ì—ì„œ HTMLì˜ `<style>` íƒœê·¸ì— ì‚½ì…í•´ìš”.

3. A Client Component that wraps your app with the style registry during initial server-side rendering.

   - í´ë¼ì´ì–¸íŠ¸ëŠ” Hydration ì‹œ ì„œë²„ë¡œë¶€í„° ì „ë‹¬ë°›ì€ CSS ìŠ¤íƒ€ì¼ì„ ì¬ì‚¬ìš©í•´ìš”.

ìœ„ì˜ ì„¤ì •ì„ ì ìš©í•œ ê²°ê³¼, ìƒˆë¡œê³ ì¹¨ì„ ëˆŒëŸ¬ì„œ ì„œë²„ë¡œë¶€í„° ìƒˆë¡œ HTMLì„ ë°›ì•„ì™€ë„ Flickeringì´ ë°œìƒí•˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="500px" src="/assets/images/2024112801/styled3.gif" alt="styled3" >
</div>

ì„œë²„ì—ì„œ ë Œë”ë§í•œ HTML íŒŒì¼ì—ì„œë„ CSS ìŠ¤íƒ€ì¼ì´ í¬í•¨ë˜ì–´ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”. `styled-components`ëŠ” `<head>` íƒœê·¸ ë‚´ë¶€ì— CSS ìŠ¤íƒ€ì¼ì„ ì£¼ì…í•´ìš”.

`styled-components: Page Source`

{% include code-header.html %}

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="/_next/static/css/app/layout.css?v=1732771235506"
      data-precedence="next_static/css/app/layout.css"
    />
    <!-- ... -->
    <style data-styled="" data-styled-version="6.1.13">
      .fGOcmy {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 16px;
        border-radius: 16px;
      } /*!sc*/
      .fGOcmy div {
        justify-content: center;
      } /*!sc*/
      .esUmar {
        display: flex;
        flex-direction: column;
        gap: 32px;
        padding: 16px;
        border-radius: 16px;
      } /*!sc*/
      .esUmar div {
        justify-content: center;
      } /*!sc*/
      data-styled.g13[id="sc-dpBQxM"] {
        content: "fGOcmy,esUmar,";
      } /*!sc*/
      /* ... */
    </style>
  </head>
  <body class="__variable_f92059 __variable_013f1d">
    <!-- ... -->
    <div class="sc-fwzISk bHRhac">
      <div class="content-box">
        <main class="sc-geXuza jnLiZN">
          <!-- ... -->
        </main>
      </div>
    </div>
    <!-- ... -->
  </body>
</html>
```

ì´í›„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ Hydrationì´ ì‹¤í–‰ë˜ë©´, `<head>` íƒœê·¸ ë‚´ë¶€ì— CSS ìŠ¤íƒ€ì¼ì´ ì˜ ì •ë¦¬ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

`styled-components: Elements íƒ­`

{% include code-header.html %}

```html
<html lang="en">
  <head>
    <!-- ... -->
    <style data-emotion="css g7laag-MuiAppBar-root" data-s="">
      .css-g7laag-MuiAppBar-root {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        width: 100%;
        box-sizing: border-box;
        -webkit-flex-shrink: 0;
        -ms-flex-negative: 0;
        flex-shrink: 0;
        position: fixed;
        z-index: 1100;
        top: 0;
        left: auto;
        right: 0;
        --AppBar-background: #1976d2;
        --AppBar-color: #fff;
        background-color: var(--AppBar-background);
        color: var(--AppBar-color);
      }
      @media print {
        .css-g7laag-MuiAppBar-root {
          position: absolute;
        }
      }
    </style>
    <style data-emotion="css zanzjh-MuiPaper-root-MuiAppBar-root" data-s="">
      .css-zanzjh-MuiPaper-root-MuiAppBar-root {
        background-color: #fff;
        color: rgba(0, 0, 0, 0.87);
        -webkit-transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
        transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
        box-shadow: var(--Paper-shadow);
        background-image: var(--Paper-overlay);
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        width: 100%;
        box-sizing: border-box;
        -webkit-flex-shrink: 0;
        -ms-flex-negative: 0;
        flex-shrink: 0;
        position: fixed;
        z-index: 1100;
        top: 0;
        left: auto;
        right: 0;
        --AppBar-background: #1976d2;
        --AppBar-color: #fff;
        background-color: var(--AppBar-background);
        color: var(--AppBar-color);
      }
      @media print {
        .css-zanzjh-MuiPaper-root-MuiAppBar-root {
          position: absolute;
        }
      }
    </style>
    <!-- ... -->
  </head>
  <!-- ... -->
</html>
```

ì´ë ‡ê²Œ ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•´ì„œ í´ë¼ì´ì–¸íŠ¸ëŠ” ë³„ë„ì˜ CSS íŒŒì¼ì´ë‚˜ ë™ì ì¸ ìŠ¤íƒ€ì¼ ì‚½ì… ì—†ì´ë„ ì„œë²„ì—ì„œ ì œê³µëœ ì™„ì „í•œ HTMLê³¼ ìŠ¤íƒ€ì¼ì„ í•œ ë²ˆì— ë°›ì•„ í™”ë©´ì— í‘œì‹œí•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ë°©ë²•ì„ **_Single Render Pass_**ë¼ê³  í•´ìš”.

ë‹¤ìŒê³¼ ê°™ì€ ì¥ì ì´ ìˆì–´ìš”.

1. CSS ìŠ¤íƒ€ì¼ê³¼ HTML ë Œë”ë§ì„ í•œ ë²ˆì˜ ë Œë”ë§ ê³¼ì •ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, HTMLì´ ì™„ì „íˆ í™”ë©´ì— ë³´ì—¬ì§€ê¸°ê¹Œì§€ ì‹œê°„ì´ ë‹¨ì¶•ë˜ê³  Flickeringì„ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.

2. ì´ëŸ¬í•œ íŠ¹ì§• ë•Œë¬¸ì—, ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‘ë‹µì„ ë¶„í• í•´ì„œ ì „ë‹¬í•˜ëŠ” ìŠ¤íŠ¸ë¦¬ë° ê¸°ë²•ì´ ê°€ëŠ¥í•´ìš”. í´ë¼ì´ì–¸íŠ¸ëŠ” HTMLì„ ì¡°ê¸ˆì”© ë°›ì„ ìˆ˜ ìˆì–´ ì´ˆê¸° ë Œë”ë§ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆì–´ìš”.

## 3. @emotion/styled ë¼ì´ë¸ŒëŸ¬ë¦¬

- ë‹¤ìŒìœ¼ë¡œ, `@emotion/styled` ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ì•Œì•„ë³¼ê²Œìš”.

### 3-1. Next.jsì—ì„œ ê¸°ì¡´ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•´ë³´ê¸°

íŠ¹ë³„í•œ ì„¤ì •ì„ ë”°ë¡œ ì ìš©í•˜ì§€ ì•Šì•„ë„, CSS ìŠ¤íƒ€ì¼ì´ ì„œë²„ ì‚¬ì´ë“œì—ì„œ ì˜ ë Œë”ë§ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ìƒˆë¡œê³ ì¹¨ì„ ì—°ì†ìœ¼ë¡œ í•´ë³´ì•„ë„, Flickering í˜„ìƒ ì—†ì´ ìì—°ìŠ¤ëŸ½ê²Œ ë Œë”ë§ë©ë‹ˆë‹¤.

<div style="display: flex; justify-content: center" >
  <img width="500px" src="/assets/images/2024112801/emotion.gif" alt="emotion" >
</div>

`styled-components` ì²˜ëŸ¼ `ServerStyleSheet` íŒŒì¼ì„ ìƒì„±í•˜ì§€ ì•Šì•„ë„ ë˜ê¸° ë•Œë¬¸ì— ìƒëŒ€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸°ì— í¸í•œ ì¥ì ì´ ìˆì–´ìš”.

ì„œë²„ì—ì„œ ì „ë‹¬í•´ì£¼ëŠ” HTML íŒŒì¼ì—ì„œë„ ìƒì„±ëœ CSS ìŠ¤íƒ€ì¼ì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”. ì„œë²„ì—ì„œ ìƒì„±ëœ CSS ìŠ¤íƒ€ì¼ì´ `<body>` íƒœê·¸ ë‚´, ì‚¬ìš©í•  ìš”ì†Œ ìœ„ì— ì„ ì–¸ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

`styled-components`ê°€ CSS ìŠ¤íƒ€ì¼ì„ `<head>` íƒœê·¸ ë‚´ì— ì‚½ì…í–ˆë˜ ê²ƒê³¼ ì°¨ì´ê°€ ìˆì–´ìš”.

`@emotion/styled: Page Source`

{% include code-header.html %}

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="/_next/static/css/app/layout.css?v=1732771235506"
      data-precedence="next_static/css/app/layout.css"
    />
    <!-- ... -->
  </head>
  <body class="__variable_f92059 __variable_013f1d">
    <!-- ... -->
    <style data-emotion="css 1qy3yb1">
      .css-1qy3yb1 {
        -webkit-flex: 1;
        -ms-flex: 1;
        flex: 1;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        overflow: auto;
      }
    </style>
    <div class="css-1qy3yb1">
      <div class="content-box">
        <style data-emotion="css 4b375e">
          .css-4b375e {
            height: 100%;
          }
        </style>
        <main class="css-4b375e">
          <!-- ... -->
        </main>
      </div>
    </div>
    <!-- ... -->
  </body>
</html>
```

ì´í›„, `styled-components`ì™€ ë§ˆì°¬ê°€ì§€ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ Hydrationì´ ì‹¤í–‰ë  ë•Œ, `<head>` íƒœê·¸ ë‚´ë¶€ì— CSS ìŠ¤íƒ€ì¼ì´ ì˜ ì •ë¦¬ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

`@emotion/styled: Elements íƒ­`

{% include code-header.html %}

```html
<html lang="en">
  <head>
    <!-- ... -->
    <style data-emotion="css 1qy3yb1" data-s="">
      .css-1qy3yb1 {
        -webkit-flex: 1;
        -ms-flex: 1;
        flex: 1;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        overflow: auto;
      }
    </style>
    <style data-emotion="css 4b375e" data-s="">
      .css-4b375e {
        height: 100%;
      }
    </style>
    <!-- ... -->
  </head>
  <!-- ... -->
</html>
```

## 4. ê³µí†µì 

`@emotion/styled`ì™€ `styled-components` ë‘˜ ë‹¤ ìœ„ì™€ ê°™ì´ CSS ìŠ¤íƒ€ì¼ì„ ì„œë²„ ì‚¬ì´ë“œì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”, íŒŒì¼ ìµœìƒë‹¨ì— `use client`ë¥¼ ì‚¬ìš©í•´ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ì–´ì•¼ í•´ìš”.

ì–¸ëœ» ë³´ë©´ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ê²Œ ë§Œë“œëŠ” ì½”ë“œë¼ê³  ìƒê°í•  ìˆ˜ë„ ìˆì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šì•„ìš”. ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë‘ `use client`ê°€ ì„ ì–¸ë˜ì—ˆë”ë¼ë„, ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ ìƒì„±í•˜ê³  ì´ˆê¸° ë Œë”ë§ì—ì„œ CSS ìŠ¤íƒ€ì¼ì„ HTMLì— ì‚½ì…í•œë‹¤ëŠ” ê²ƒì— ìœ ì˜í•˜ê³  ì‚¬ìš©í•´ì•¼ í•´ìš”.

`ğŸ“‚ Test.tsx`

{% include code-header.html %}

```tsx
"use client";
import styled from "styled-components";
import { ReactNode } from "react";

const TestComponent = ({ children }: { children: ReactNode }) => {
  return <StyledTest>{children}</StyledTest>;
};

export default TestComponent;

const StyledTest = styled.div`
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: auto;
`;
```

`ğŸ“‚ layout.tsx`

{% include code-header.html %}

```tsx
import StyledComponentsRegistry from "./registry";
import TestComponent from "./Test";

// ...

return (
  <html lang="en">
    <body>
      <StyledComponentsRegistry>
        <TestComponent>
          <div className="content-box">{children}</div>
        </TestComponent>
      </StyledComponentsRegistry>
    </body>
  </html>
);
```

`use client`ë¡œ ì„ ì–¸í•œ `TestComponent` ì»´í¬ë„ŒíŠ¸ì˜ `StyledTest`ì˜ CSS ìŠ¤íƒ€ì¼ì´ HTMLì— í¬í•¨ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="800px" src="/assets/images/2024112801/useclient.png" alt="useclient" >
</div>

`use client`ë¥¼ ì„ ì–¸í•´ë„ ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ ìƒì„±ì´ ë˜ê¸° ë•Œë¬¸ì— `styled-components`ë‚˜ `@emotion/styled`ë¥¼ ì‚¬ìš©í•  ë•Œ, í•„ìš”í•˜ë©´ `use client`ë¥¼ ììœ ë¡­ê²Œ ì‚¬ìš©í•´ë„ ë¼ìš”.

í•˜ì§€ë§Œ `use client`ë¥¼ ë‚¨ìš©í•˜ê²Œ ë˜ë©´, í´ë¼ì´ì–¸íŠ¸ ë Œë”ë§ë˜ëŠ” ë¶€ë¶„ì´ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— SEOì— ì•…ì˜í–¥ì´ ìˆê±°ë‚˜ Javascript ë²ˆë“¤ ìµœì í™”ê°€ ì–´ë ¤ì›Œì§€ëŠ” ë‹¨ì ì´ ìˆì–´ìš”. ë”°ë¼ì„œ ë°˜ë“œì‹œ í•„ìš”í•œ ë¶€ë¶„ì—ë§Œ `use client`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì•„ìš”.

ê·¸ë¦¬ê³  ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”, ìœ„ì˜ `TestComponent`ì˜ ê²½ìš°ì²˜ëŸ¼ íŒŒì¼ì„ ë¶„ë¦¬í•´ì•¼ í•  ìˆ˜ë„ ìˆì–´ìš”. ì´ëŸ° ê³¼ì •ì´ ë²ˆê±°ë¡œìš¸ ë•Œì—ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ì‹ , Next.jsì˜ CSS ëª¨ë“ˆì´ë‚˜ Global CSSì²˜ëŸ¼ ë‹¤ë¥¸ ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆì–´ìš”.

## 5. ì°¨ì´ì 

### ë³„ë„ì˜ ì„¤ì • ì—¬ë¶€

- `@emotion/styled`: ë³µì¡í•œ `ServerStyleSheet` ì„¤ì •ì´ í•„ìš”ì—†ì´, í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.

- `styled-components`: `ServerStyleSheet`ê³¼ ê¸°íƒ€ íŒŒì¼ ì„¤ì •ì´ í•„ìš”í•´ìš”.

### ë™ì‘ ë°©ì‹

- `@emotion/styled`: ì„œë²„ì—ì„œ ë Œë”ë§ëœ ìŠ¤íƒ€ì¼ì„ `<head>` íƒœê·¸ ë‚´ì— í¬í•¨ì‹œì¼œ ì „ë‹¬í•´ìš”.

- `styled-components`: ì„œë²„ì—ì„œ ë Œë”ë§ëœ ìŠ¤íƒ€ì¼ì„ `<body>` íƒœê·¸ ë‚´ì— í¬í•¨ì‹œì¼œ ì „ë‹¬í•´ìš”.

### Material UIì™€ì˜ í˜¸í™˜ì„±

`Material UI`ëŠ” `styled-components`ì™€ í˜¸í™˜ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  [Material UI ê³µì‹ ë¬¸ì„œ](https://mui.com/material-ui/integrations/styled-components/)ì— ë‚˜ì™€ ìˆì–´ìš”.

`Material UI`ëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ìœ„í•˜ì—¬ ë‚´ë¶€ì ìœ¼ë¡œ `@emotion`ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ì—ì„œëŠ” `@emotion/styled`ê°€ ë” ì í•©í•œ ì„ íƒì´ì—ìš”.

`styled-components`ì™€ `Material UI`ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ì„œ ì•„ë˜ì™€ ê°™ì€ ë²„ê·¸ë¥¼ ë°œê²¬í–ˆì–´ìš”.

<div style="display: flex; justify-content: center" >
  <img width="500px" src="/assets/images/2024112801/mui.gif" alt="mui" >
</div>

{% include code-header.html %}

```tsx
import Slider from "@mui/material/Slider";
import styled from "styled-components";

<QuizOptionLayout title="Rounds" spacing="large">
  <SliderWrapper
    aria-label="quiz-round"
    defaultValue={round}
    step={10}
    min={10}
    valueLabelDisplay="on"
    marks={roundMarks}
    onChange={handleRoundChange}
  />
</QuizOptionLayout>;

const SliderWrapper = styled(Slider)`
  width: 80%;
`;
```

`styled(Slider)`ì²˜ëŸ¼ ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ê²Œ ë˜ë©´, Flickering í˜„ìƒì´ ë°œìƒí•´ìš”. ì„œë²„ì—ì„œ ìƒì„±ëœ HTMLì„ í™•ì¸í•˜ë©´ ë¶„ëª…íˆ ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì´ ìƒì„±ë˜ê³  ì „ë‹¬ë˜ëŠ”ë° ì—¬ì „íˆ Flickeringì´ ë‚˜íƒ€ë‚˜ìš”.

{% include code-header.html %}

```html
.hjUJLN{width:80%;}/*!sc*/
data-styled.g17[id="QuizOptions__SliderWrapper-sc-753c67a3-2"]{content:"hjUJLN,"}/*!sc*/
<span
  class="MuiSlider-root MuiSlider-marked MuiSlider-colorPrimary MuiSlider-sizeMedium sc-cEzcPc hjUJLN css-1e45yg4-MuiSlider-root"
>
  // ...
</span>
```

ì•„ë˜ì²˜ëŸ¼ êµ¬ì¡°ë¥¼ ë³€ê²½í–ˆë”ë‹ˆ Flickering ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆì–´ìš”. ë‘ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì´ ì„œë¡œ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ìˆ˜ë„ ìˆì–´ìš”. ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°„ì˜ êµ¬ë¶„ì„ ëª…í™•í•˜ê²Œ í•˜ê±°ë‚˜, ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ `@emotion/styled`ë¡œ ë³€ê²½í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆì–´ìš”.

{% include code-header.html %}

```tsx
import Slider from "@mui/material/Slider";
import styled from "styled-components";

<QuizOptionLayout title="Rounds" spacing="large">
  <SliderWrapper>
    <Slider
      aria-label="quiz-round"
      defaultValue={round}
      step={10}
      min={10}
      valueLabelDisplay="on"
      marks={roundMarks}
      onChange={handleRoundChange}
    />
  </SliderWrapper>
</QuizOptionLayout>;

const SliderWrapper = styled.div`
  width: 80%;
`;
```

## 6. í”„ë¡œì íŠ¸ì—ì„œì˜ ì„ íƒ: @emotion/styled

1. ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ `Material UI`ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ `@emotion`ì™€ í˜¸í™˜ì´ ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì„ íƒí•˜ì˜€ì–´ìš”.

2. `styled-components`ì²˜ëŸ¼ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì ìš©í•˜ê¸° ìœ„í•´ ì‘ì„±í•´ì•¼ í•˜ëŠ” íŒŒì¼ì´ ì—†ë‹¤ëŠ” ì ì´ ì‚¬ìš©í•˜ê¸°ì— ë” í¸í•˜ê¸° ë•Œë¬¸ì— ì„ íƒí•˜ì˜€ì–´ìš”.

## 7. ê²°ë¡ 

### styled-components

- ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ, `next.config.mjs`ì™€ `ServerStyleSheet` ì„¤ì •ì´ í•„ìš”í•´ìš”.
  - `next.config.mjs`: í´ë˜ìŠ¤ë„¤ì„ ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ í•´ê²°í•´ìš”.
  - `ServerStyleSheet`: Flickering ë¬¸ì œë¥¼ í•´ê²°í•´ìš”.

### @emotion/styled

- ë³„ë„ì˜ ì„¤ì • ì—†ì´ë„ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ì§€ì›í•´ìš”.

### ê³µí†µì 

- `styled` ë“± APIë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `use client` ì„ ì–¸ì´ í•„ìš”í•´ìš”.
- í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ì–´ë„ ì„œë²„ì—ì„œ CSS ìŠ¤íƒ€ì¼ì´ ìƒì„±ë¼ìš”.

### ì°¨ì´ì 

- ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ í•˜ê¸° ìœ„í•´ ë³„ë„ì˜ ì„¤ì • ì—¬ë¶€ê°€ ë‹¬ë¼ìš”.
- ë‚´ë¶€ì ì¸ ë™ì‘ ë°©ì‹ì´ ë‹¬ë¼ìš”.
- Material UIì™€ì˜ í˜¸í™˜ì„±ì— ì°¨ì´ê°€ ìˆì–´ìš”.

## Reference

- [Next.js Babel í”ŒëŸ¬ê·¸ì¸](https://styled-components.com/docs/tooling#server-side-rendering)
- [@emotion/styled ê´€ë ¨ GitHub Issue](https://github.com/emotion-js/emotion/issues/2004)
- [@emotion/styledê³¼ Next.jsì˜ í˜¸í™˜ì„±](https://emotion.sh/docs/ssr#nextjs)
- [Next.jsì—ì„œ styled-componentsë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•](https://nextjs.org/docs/app/building-your-application/styling/css-in-js#styled-components)
- [Material UIì™€ styled-components](https://mui.com/material-ui/integrations/styled-components/)
